#!/bin/sh
. "$(dirname "$0")/_/husky.sh"

echo "🧪 Running environment check before push..."

# Default to production unless specified
ENV="${ENV:-production}"

# Run the check
node ./src/check-env.js $ENV

if [ $? -ne 0 ]; then
  echo "❌ Env check failed. Push aborted."
  exit 1
fi

echo "✅ Env check passed. Proceeding with push..."

npm test

if [ $? -ne 0 ]; then
  echo "❌ Unit Tests Failed. Push aborted."
  exit 1
fi

echo "✅ Test Passed. Proceeding with push..."